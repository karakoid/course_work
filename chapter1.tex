\chapter{ОСНОВНЫЕ ПОНЯТИЯ И ОБЗОР ЛИТЕРАТУРЫ }\label{chap1}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Теория управления по прогнозирующей модели}\label{1sec:MPC}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\subsection{Прогнозирующая модель}
\label{Predictive model}


Рассмотрим нелинейную дискретную прогнозирующую модель вида:
\begin{equation}
	x^+ = f(x, u),
\end{equation}
где функция $ f: X \times U \longrightarrow X $ ставит в соответствие паре $ x \in \mathbb{X} $ и $ u \in \mathbb{U} $ некоторое состояние $ x^+ \in \mathbb{X} $, которое является состоянием системы в последующий момент времени. \par
Траектория системы (1.1) может быть получена следующим образом: с заранее заданным значением $ x_0 \in \mathbb{X} $, а также с управлением $ u(\cdot) \in \mathbb{U}^k,\; k \in \mathbb{N}_\infty $, можно определить значение траектории $ x_u(k) $ итерационно через
\begin{equation}
	x(0) = x_0,\; x_u(k + 1) = f(x_u(k), u(k)),
\end{equation}
для всех $ k \in \mathbb{N}_0 $, если $ k = \infty $, и $ k = 0, 1, ... ,k - 1 $ в другом случае.


\subsection{Ограничения}
\label{Constraints}


Одна из основных частей MPC --- ограничения. Они могут быть установлены как на управление, так и на состояние системы. Введем непустое множество $ X \subseteq \mathbb{X} $ и для каждого $ x \in \mathbb{X} $ введем непустое множество ограничений $ \mathbb{U}(x)\subseteq U $. Множество ограничений $ \mathbb{U}(x) $ может и не зависеть от x. За введением ограничений стоит наше желание указать, что траектория лежит во множестве $ \mathbb{X} $, а соответствующее траектории управление лежит во множестве $ \mathbb{U}(x) $.


\subsection{Критерий качества}
\label{Quality criterion} 


Пусть $ x_* \in X $ --- точное решение системы (номер). Тогда функция стоимости, которая используется в нашем процессе оптимизации, в критерии качества, должна возвращать значение, основанное на растоянии от любого $ x \in X $ до $ x_* $. В дополнение к уже сказанному, желательно, чтобы функция стоимости также включала в себя оценку расстояний и по управлению $ u \in U $. По вычислительным причинам намного удобнее, чтобы управление также оценивалось функцией стоимости. Также оценка управления может быть полезна с точки зрения моделирования, т.к. мы не хотим использовать управление, затратное по ресурсам или энергии. Благодаря этим причинам, мы выбираем функцию стоимости вида $ l: X \times U \longrightarrow \mathbb{R}_0^+ $. \par
Из всего вышесказанного, можно сделать вывод, что функция стоимости обладает следующими свойствами:
\begin{align}
	&l(x_*, u_*) = 0,\\
	&l(x, u) > 0, \; x \in X, \; u \in U, \; x \neq x_*.
\end{align}


\subsection{Базовая формулировка задачи оптимального программирования с конечным горизонтом}
\label{Basic wording}


Базовая формулировка задачи оптимального программирования с конечным горизонтом имеет вид: необходимо минимизировать критерий качества на траектории нелинейной дискретной системы с ограничениями на управление
\begin{align}
	&J_N(x_0, u(\cdot)) = \Sigma_{k = 0}^{N - 1} l(x_u(k, x_0), u(k)) \longrightarrow min,\\
	&x_u(k + 1, x_0) = f(x_u(k, x_0), u(k)), \; x_u(0, x_0) = x_0,\\
	&u(\cdot) \in \mathbb{U}^N(x_0).
\end{align}


\subsection{Базовый алгоритм MPC}
\label{Basic MPC algorithm}


Идея схемы MPC выглядит так: в каждый момент квантования $ n $ оптимизируем предсказанное поведение системы и используем первый элемент результирующей последовательности управлений в качестве значения оценки в следующий момент квантования. Таким образом, базовый алгоритм MPC будет иметь следующий вид: \bigskip

в каждый момент квантования $ t_n, \; n = 0, 1, 2, ... $
\begin{enumerate}
	\item вычисляем состояние $ x(n) \in X $ системы (номер),
	
	\item принимаем $ x_0 = x(n) $ и решаем задачу оптимального управления, сформулированную в предыдущем пункте 1.1.4 (номер - номер), после чего обозначим полученную последовательность оптимальных управлений через $ u^*(\cdot) \in \mathbb{U}^N(x_0) $,
	
	\item определим \textbf{\textit{оценочное значение}} $ \mu_N(x(n)) = u^*(0) \in U $ и используем это значение управления в следующем периоде квантования.
\end{enumerate}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Задачи оптимального управления}
\label{1sec:OCP}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\subsection{Классификация задач оптимального управления}
\label{OCP:Classification}


Задачи оптимального управления классифицируются по следующим составляющим:
\begin{itemize}

	\item Промежуток времени и управления.\par
	Промежуток времени в задачах оптимального управления может быть как непрерывным, т.е. $ t \in \mathbb{R} $, так и дискретным, а именно $ k \in \mathbb{Z}_+ $. В то же время, промежуток управления может быть конечным, что значит $ t \in [t_0, t_f],\; t_0 < t_f $, и бесконечным, где $ t \in [t_0, +\infty) $. Время окончания процесса в свою очередь также может быть подразделено на фиксированное, т.е $ t_f $ заданно, и не фиксированное, где $ t_f $ уже заданно не будет. \par
		
	\item Математическая модель объекта управления. \par
	Будем рассматривать объекты управления, которые можно описать обыкновенными 		дифференциальными уравнениями: 
		\begin{equation}
			\dot x = f(x, u, t),
		\end{equation} где
		$ x = x(t) \in \mathbb{R}^n $ --- состояние системы,
		$ u = u(t) \in \mathbb{R}^r $ --- управление.
		
	\item Классы управлений и ограничение на управление. \par
	Классы управлений могут подразделяться на кусочно-непрерывные, измеримые, дискретные, релейные, инерционные и др. функции.
	
	Ограничение на управление: \par
	$ u(t) \in U(t),\; t \in [t_0, t_f] $, где $ U(t) \subseteq \mathbb{R}^n $.
	
	\item Ограничения на траекторию. \par
	В общем виде ограничения на траекторию имеют вид:
		\begin{equation}
			x \in \mathbb{X}(t),\; t \in [t_0, t_f].
		\end{equation}
	Ограничения на траекторию могут накладываться: \par
		\begin{itemize}
			\item на правом конце траектории (терминальные ограничения), т.е.
			$ x(t_f) \in \mathbb{X}_f $, откуда могут вытекать задачи с 						закрепленным, свободным и подвижным правым концом траектории;
			\item на левом конце траектории, т.е. $ x(t_0) \in \mathbb{X}_0 $,
			откуда также могут вытекать задачи с закрепленным, свободным и 						подвижным концом траектории;
			\item в промежуточные моменты времени, т.е.
			$ x(t_i) \in \mathbb{X}_i,\; t_i \in [t_0, t_f],\; i = 1, ... , l $,
			при этом $ t_0 < t_1 < ... < t_l < t_f $.
		\end{itemize}
	Существуют и смешанные ограничения на траекторию.
	
	\item Критерий качества.
		\begin{itemize}
			\item Терминальный критерий (критерий качества типа Майера)\par
				$ J(u)=\varphi(x(t_f)),\;
				\varphi: \mathbb{R}^n \longrightarrow \mathbb{R} $;
			\item Интегральный критерий (критерий качества типа Лагранжа) \par
				$ J(u)=\int_{t_0}^{t_f}f_0(x(t), u(t), t)dt,
				\;f_0: \mathbb{R}^n \times \mathbb{R}^r \times \mathbb{R} 							\longrightarrow \mathbb{R} $;
			\item Критерий качества типа Больца \par
				$ J(u)=\varphi(x(t_f)) + \int_{t_0}^{t_f}f_0(x(t),u(t),t)dt $;
			\item Критерий быстродействия \par
				$ J(u)=t_f - t_0 \longrightarrow min $.
		\end{itemize}
	
\end{itemize}


\subsection{Принцип максимума для простейшей задачи оптимального управления}
\label{OCP:Simplest OCP}


Рассмотрим простейшую задачу оптимального управления на промежутке времени
$ [t_0, t_f] $ в классе кусочно-непрерывных управлений: \par
\begin{align}
	&J(u)=\varphi(x(t_f)) \longrightarrow min, \\
	&\dot x = f(x, u, t),\; x(t_0) = x_0,  \\
	&u(t) \in \mathbb{U},\; t \in [t_0, t_f].
\end{align}
В задаче (номер откуда до куда) необходимо минимизировать критерий типа Майера (номер) на траектории нелинейной системы (номер) с ограничениями на управление (номер). \par
Принцип максимума. \par
Пусть $ u^0(t),\; t \in [t_0, t_f] $ --- оптимальное управление, $ x^0(t),\; t \in [t_0, t_f] $ --- оптимальная траектория, $ \psi^0(t), \; t \in [t_0, t_f] $ --- сопряженная траектория --- решение сопряженного уравнения
\begin{align}
	&\psi' = -\frac{\partial H(x^0(t), \psi, u^0(t), t)}{\partial x}, \\
	&\psi = -\frac{\partial \varphi (x^0(t_f))}{\partial x}.
\end{align}
Тогда необходимо выполняется условие максимума гамильтониана:
\begin{equation}
	H(x^0(t), \psi^0(t), u^0(t), t) = \max_{u \in \mathbb{U}} H(x^0(t), \psi^0(t), u, t), \; t \in [t_0, t_f].
\end{equation}


\subsection{Алгоритм решения задач оптимального управления с помощью принципа максимума}
\label{OCP:Maximum Principle}


Алгоритм решения задачи оптимального управления (номер-номер) из предыдущего пункта состоит из: \par
\begin{itemize}
	\item составления гамильтониана \par
		\begin{equation}
			H(x, u, \psi, t) = \psi'f(x, u, t),
		\end{equation} где $ \psi = \psi(t) \in \mathbb{R}^n $;
	\item записи сопряженной системы и условия трансверсальности
		\begin{align}
			&\dot \psi = -\frac{\partial H(x, u, \psi, t)}{\partial x}, \\
			&\psi (t_f) = -\frac{\partial \varphi (x(t_f))}{\partial x};
		\end{align}
	\item условия максимума гамильтониана
		\begin{equation}
			H(x^0(t), \psi^0(t), u^0(t), t) = \max_{u \in \mathbb{U}} 							H(x^0(t), \psi^0(t), u(t), t),\; t \in [t_0, t_f];
		\end{equation}
	\item рассмотрения задачи максимума гамильтониана
		\begin{equation}
			H(x, \psi, u, t) \longrightarrow max,
		\end{equation} где $ x, \psi, t $ предполагаются фиксированными.
	\item результата решения предыдущего пункта
		\begin{equation}
			u(x, \psi, t) = arg \max_{u \in \mathbb{U}} H(x, \psi, u, t);
		\end{equation}
	\item подстановки результата в прямую и сопряженную систему
		\begin{align}
			&\dot x = f(x, u(x, \psi, t), t), \\
			&\dot \psi = -\frac{\partial H(x, \psi, u(x, \psi, t), t)}							{\partial x}, \\
			&x(t_0) = x_0,\;
				\psi(t_f) = -\frac{\partial \varphi (x(t_f))}{\partial x};
		\end{align}
	\item решения краевой задачи принципа максимума (номер - номер)
		\begin{align}
			&x(t), \psi (t),\; t \in [t_0, t_f], \\
			&u(t) = u(x(t), \psi (t), t),\; t \in [t_0, t_f].
		\end{align}
\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Численные методы решения задач оптимального управления и программные средства}
\label{1sec:NM&Software}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%