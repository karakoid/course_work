clear
clc
close all

%% Model
g = 9.8;
Ac = [0 1 0 0 0 0  0 0 0 0 0 0;
      0 0 0 0 0 0  0 0 g 0 0 0;
      0 0 0 1 0 0  0 0 0 0 0 0;
      0 0 0 0 0 0 -g 0 0 0 0 0;
      0 0 0 0 0 1  0 0 0 0 0 0;
      0 0 0 0 0 0  0 0 0 0 0 0;
      0 0 0 0 0 0  0 1 0 0 0 0;
      0 0 0 0 0 0  0 0 0 0 0 0;
      0 0 0 0 0 0  0 0 0 1 0 0;
      0 0 0 0 0 0  0 0 0 0 0 0;
      0 0 0 0 0 0  0 0 0 0 0 1;
      0 0 0 0 0 0  0 0 0 0 0 0];  
Bc = [0 0 0 0;
      0 0 0 0;
      0 0 0 0;
      0 0 0 0;
      0 0 0 0;
      0.0254 0.0245 0.0254 0.0254;
      0 0 0 0 ;
      0 -1.5424 0 1.5424;
      0 0 0 0;
      -1.5424 0 1.5424 0;
      0 0 0 0;
      0.004381 -0.004381 0.004381 -0.004381];  

Cc = eye(12);
Dc = zeros(12,4);

K = [1 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 1 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 1 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0];
                       
%% Linear model
Ts=0.05;
[A,B,C,D] = c2dm(Ac,Bc,Cc,Dc,Ts);
sys = ss(A,B,C,D,Ts);
clear Ac Bc Cc Dc

%% Initial state
x1_0 = 0; % x
x2_0 = 0; % dx
x3_0 = 0; % y
x4_0 = 0; % dy
x5_0 = 0; % z
x6_0 = 0; % dz
x7_0 = 0; % phi
x8_0 = 0; % dphi
x9_0 = 0; % theta
x10_0= 0; % dtheta
x11_0= 0; % psi
x12_0= 0; % dpsi

%% Constraints
xmax = 16;
xmin = 14;
ymax = 11;
ymin = 9;
zmax = 6;
zmin = 0;
phi_max = pi / 12;
phi_min = -pi /12;
theta_max = pi / 12;
theta_min = -pi / 12;

%% Weights
% Control weights
wu1 = 0.1;
wu2 = 0.1;
wu3 = 0.1;
wu4 = 0.1;
%Output weights
wx1 = 1;
wx2 = 1;
wx3 = 1;
wx4 = 1;
wx5 = 10;
wx6 = 10;
wx7 = 10;
wx8 = 10;
wx9 = 10;
wx10 = 10;
wx11 = 10;
wx12 = 10;